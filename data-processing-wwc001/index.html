<!doctype html>
<html class="no-js" lang="en">
<head>
		<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Data Processing Methodology for "Tracking the Energy Titans"</title>
	<link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/styles_feeling_responsive.css" />
	<script src="http://localhost:4000/assets/js/modernizr.min.js"></script>

  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
  <script>
    WebFont.load({
      google: {
        families: [ 'Lato:400,700,400italic:latin', 'Work+Sans:400,700:latin' ]
      }
    });
  </script>

  <noscript>
    <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css' />
  </noscript>

  <meta name="google-site-verification" content="hb0oFgJAnd2i2LvJYSEIofF5sc24xc8hx2tTNittvHA" />
	
	<meta name="description" content="Parsing irregularly formatted CSV files for a visualizaiton with D3JS." />

	<link rel="author" href="https://plus.google.com/u/0/103791827597799558729"/>

	



	
	<link rel="icon" sizes="32x32" href="http://localhost:4000/assets/img/favicon-32x32.png" />




	
	<link rel="icon" sizes="192x192" href="http://localhost:4000/assets/img/touch-icon-192x192.png" />




	
	<link rel="apple-touch-icon-precomposed" sizes="180x180" href="http://localhost:4000/assets/img/apple-touch-icon-180x180-precomposed.png" />




	
	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://localhost:4000/assets/img/apple-touch-icon-152x152-precomposed.png" />




	
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/assets/img/apple-touch-icon-144x144-precomposed.png" />




	
	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="http://localhost:4000/assets/img/apple-touch-icon-120x120-precomposed.png" />




	
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/assets/img/apple-touch-icon-114x114-precomposed.png" />




	
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="http://localhost:4000/assets/img/apple-touch-icon-76x76-precomposed.png" />




	
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/assets/img/apple-touch-icon-72x72-precomposed.png" />




	
	<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/assets/img/apple-touch-icon-precomposed.png" />	




	
	<meta name="msapplication-TileImage" content="http://localhost:4000/assets/img/msapplication_tileimage.png" />




	
	<meta name="msapplication-TileColor" content="#fabb00" />



	<!-- Facebook Optimization -->
	<meta property="og:locale" content="en_EN" />
	
	<meta property="og:title" content="Data Processing Methodology for "Tracking the Energy Titans"" />
	<meta property="og:description" content="The portfolio and technical blog of Chris Henrick – provider of professional web development, data visualization, GIS, mapping, &amp; cartography services." />
	<meta property="og:url" content="http://localhost:4000//data-processing-wwc001/" />
	<meta property="og:site_name" content="Chris Henrick – Web Development, Data Visualization, GIS, Maps, and Cartography" />
	

	

	<!-- Search Engine Optimization -->
	<meta name="description" content="">
	<meta name="google-site-verification" content="hb0oFgJAnd2i2LvJYSEIofF5sc24xc8hx2tTNittvHA">
	
	
	<link rel="author" href="https://plus.google.com/u/0/103791827597799558729">
	
	
	<link rel="canonical" href="http://localhost:4000/data-processing-wwc001/">

	
	<!-- Twitter -->
	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@chrislhenrick">
	<meta name="twitter:creator" content="@chrislhenrick">
	<meta name="twitter:title" content="Chris Henrick – Web Development, Data Visualization, GIS, Maps, and Cartography">
	<meta name="twitter:description" content="The portfolio and technical blog of Chris Henrick – provider of professional web development, data visualization, GIS, mapping, & cartography services.">
	<meta name="twitter:image" content="http://localhost:4000/images/clhenrick-landing-header.jpg">
	

	<link type="text/plain" rel="author" href="http://localhost:4000/humans.txt" />

	

	
</head>

</head>
<body id="top-of-page" class="">
	
	
<div id="navigation" class="sticky">
  <nav class="top-bar" role="navigation" data-topbar>
    <ul class="title-area">
      <li class="name">
      <h1 class="show-for-small-only"><a href="http://localhost:4000" class="icon-tree"> Chris Henrick</a></h1>
    </li>
       <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
      <li class="toggle-topbar menu-icon"><a href="#"><span></span></a></li>
    </ul>
    <section class="top-bar-section">

      <ul class="right">
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
            
            
              <li class="divider"></li>
              <li><a href="http://localhost:4000/search/">Search</a></li>

            
            
          
        

              

          
          
            
            
              <li class="divider"></li>
              <li><a href="http://localhost:4000/contact/">Contact</a></li>

            
            
          
        
        
      </ul>

      <ul class="left">
        

              

          
          

            
            
              <li><a href="http://localhost:4000/">clhenrick</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a href="http://localhost:4000/work/">Work</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            

              <li class="has-dropdown">
                <a href="http://localhost:4000/about/">About</a>

                  <ul class="dropdown">
                    

                      

                      <li><a href="http://localhost:4000/about/cv/">CV</a></li>
                    

                      

                      <li><a href="http://localhost:4000/about/talks/">Talks</a></li>
                    
                  </ul>

              </li>
              <li class="divider"></li>
            
          
        

              

          
          

            
            

              <li class="has-dropdown">
                <a href="http://localhost:4000/blog/">Blog</a>

                  <ul class="dropdown">
                    

                      

                      <li><a href="http://localhost:4000/blog/archive/">Blog Archive</a></li>
                    
                  </ul>

              </li>
              <li class="divider"></li>
            
          
        

              

          
          
        

              

          
          
        
        
      </ul>
    </section>
  </nav>
</div><!-- /#navigation -->

	

	





	<div class="row t30">
	<div class="medium-8 columns medium-offset-2 end">
		<article itemscope itemtype="http://schema.org/Article">
			<header>
				

				<span itemprop="name">
					
					<h1>Data Processing Methodology for "Tracking the Energy Titans"</h1>
				</span>
			</header>


			
			<p class="teaser" itemprop="description">
				Parsing irregularly formatted CSV files for a visualizaiton with D3JS.
			</p>
			

			<span itemprop="articleSection">
			<h2 id="background">Background</h2>
<p>For my first project at <a href="http://radishlab.com/">Radish Lab</a> I assisted with creating an interactive data-visualization for the <a href="http://www.wilsoncenter.org/">Woodrow Wilson Center</a> called <a href="#">Tracking the Energy Titans</a> that compares energy consumption and exports between the U.S., Canada, and China. One of my roles in creating this interactive was to take raw data provided by WWC and convert it to a structure and format that plays nicely with D3JS, a data-visualization javascript library that is being used to draw the charts in the interactive. Rather than manually reformatting the data in a program like Excel, I chose to write a <a href="https://nodejs.org/">Node JS</a> script which would parse the data and output it to a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON">JSON</a> data format. The following post describes the process of how I accomplished this.</p>

<h2 id="about-the-data">About the Data</h2>
<p>To facilitate communication with the client about the data Radish Lab utilized Google Drive’s Sheets App, which works in a similar fashion to Microsoft’s Excel software. This way we could see any updates made to data by the client in real time and give them feedback without having to send files back and forth via email or an FTP. The Google Sheets document contained a total of 8 worksheets: two worksheets for each country representing per-capita and total data, a sheet listing the data sources, and another containing interesting facts relating to the data called “Wow-Factors.”</p>

<p>Here is a sample of the United State’s total country data in tabular format:</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
      <th>Unit of Measure</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Production</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Coal</td>
      <td>Mtce</td>
      <td>846</td>
      <td>859</td>
      <td>778</td>
      <td>793</td>
      <td>800</td>
      <td>744</td>
      <td>720</td>
    </tr>
    <tr>
      <td> </td>
      <td>Gas</td>
      <td>Mtce</td>
      <td>712</td>
      <td>745</td>
      <td>761</td>
      <td>785</td>
      <td>843</td>
      <td>887</td>
      <td>896</td>
    </tr>
    <tr>
      <td> </td>
      <td>Oil</td>
      <td>Mtce</td>
      <td>474</td>
      <td>469</td>
      <td>501</td>
      <td>517</td>
      <td>538</td>
      <td>612</td>
      <td>692</td>
    </tr>
    <tr>
      <td> </td>
      <td>Nuclear</td>
      <td>Mtce</td>
      <td>305</td>
      <td>303</td>
      <td>301</td>
      <td>304</td>
      <td>298</td>
      <td>290</td>
      <td>298</td>
    </tr>
    <tr>
      <td> </td>
      <td>Hydro</td>
      <td>Mtce</td>
      <td>30</td>
      <td>31</td>
      <td>33</td>
      <td>32</td>
      <td>39</td>
      <td>34</td>
      <td>33</td>
    </tr>
    <tr>
      <td> </td>
      <td>Renewables (Solar Wind)</td>
      <td>Mtce</td>
      <td>4.3</td>
      <td>6.9</td>
      <td>9.2</td>
      <td>11.8</td>
      <td>15</td>
      <td>17.8</td>
      <td>21.7</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Imports</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Coal</td>
      <td>Mtce</td>
      <td>35</td>
      <td>34</td>
      <td>21</td>
      <td>19</td>
      <td>13</td>
      <td>9</td>
      <td>8</td>
    </tr>
    <tr>
      <td> </td>
      <td>Gas</td>
      <td>Mtce</td>
      <td>170</td>
      <td>147</td>
      <td>138</td>
      <td>138</td>
      <td>128</td>
      <td>116</td>
      <td>106</td>
    </tr>
    <tr>
      <td> </td>
      <td>Crude Oil</td>
      <td>Mtce</td>
      <td>789</td>
      <td>772</td>
      <td>709</td>
      <td>725</td>
      <td>705</td>
      <td>693</td>
      <td>613</td>
    </tr>
    <tr>
      <td> </td>
      <td>Oil Products</td>
      <td>Mtce</td>
      <td>247</td>
      <td>225</td>
      <td>194</td>
      <td>188</td>
      <td>180</td>
      <td>149</td>
      <td>146</td>
    </tr>
    <tr>
      <td> </td>
      <td>Electricity</td>
      <td>Mtce</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>6</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Exports</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Coal</td>
      <td>Mtce</td>
      <td>56</td>
      <td>76</td>
      <td>56</td>
      <td>77</td>
      <td>100</td>
      <td>112</td>
      <td>105</td>
    </tr>
    <tr>
      <td> </td>
      <td>Gas</td>
      <td>Mtce</td>
      <td>30</td>
      <td>35</td>
      <td>39</td>
      <td>41</td>
      <td>55</td>
      <td>59</td>
      <td>57</td>
    </tr>
    <tr>
      <td> </td>
      <td>Crude Oil</td>
      <td>Mtce</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <td> </td>
      <td>Oil Products</td>
      <td>Mtce</td>
      <td>106</td>
      <td>135</td>
      <td>149</td>
      <td>171</td>
      <td>213</td>
      <td>229</td>
      <td>250</td>
    </tr>
    <tr>
      <td> </td>
      <td>Electricity</td>
      <td>Mtce</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Consumption</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Power Sector</td>
      <td>Mtce</td>
      <td>1369</td>
      <td>1348</td>
      <td>1272</td>
      <td>1326</td>
      <td>1295</td>
      <td>1260</td>
      <td>1263</td>
    </tr>
    <tr>
      <td> </td>
      <td>Transport</td>
      <td>Mtce</td>
      <td>1046</td>
      <td>1000</td>
      <td>974</td>
      <td>990</td>
      <td>979</td>
      <td>962</td>
      <td>971</td>
    </tr>
    <tr>
      <td> </td>
      <td>Industry</td>
      <td>Mtce</td>
      <td>895</td>
      <td>862</td>
      <td>789</td>
      <td>850</td>
      <td>857</td>
      <td>866</td>
      <td>893</td>
    </tr>
    <tr>
      <td> </td>
      <td>Residential</td>
      <td>Mtce</td>
      <td>409</td>
      <td>418</td>
      <td>408</td>
      <td>415</td>
      <td>409</td>
      <td>377</td>
      <td>411</td>
    </tr>
    <tr>
      <td> </td>
      <td>Commercial</td>
      <td>Mtce</td>
      <td>305</td>
      <td>312</td>
      <td>306</td>
      <td>308</td>
      <td>309</td>
      <td>296</td>
      <td>309</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Impact</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>CO2 Emissions</td>
      <td>Megaton*</td>
      <td>5851.51</td>
      <td>5667.24</td>
      <td>5295.18</td>
      <td>5425.19</td>
      <td>5304.77</td>
      <td>5173.52</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td> </td>
      <td>Water Use</td>
      <td>Billions of gallons per day</td>
      <td>409</td>
      <td>404.6</td>
      <td>404.6</td>
      <td>355</td>
      <td>355</td>
      <td>355</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Losses - Power Sector</td>
      <td>Mtce</td>
      <td>878</td>
      <td>860</td>
      <td>804</td>
      <td>839</td>
      <td>810</td>
      <td>782</td>
      <td>784</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td>*Million Metric Ton</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>And another for the United State’s per-capita data:</p>

<table>
  <thead>
    <tr>
      <th>US per capita</th>
      <th> </th>
      <th>Unit of Measure</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Production</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Coal</td>
      <td>tce</td>
      <td>2.800</td>
      <td>2.825</td>
      <td>2.536</td>
      <td>2.564</td>
      <td>2.568</td>
      <td>2.370</td>
      <td>2.278</td>
    </tr>
    <tr>
      <td> </td>
      <td>Gas</td>
      <td>tce</td>
      <td>2.364</td>
      <td>2.450</td>
      <td>2.481</td>
      <td>2.538</td>
      <td>2.706</td>
      <td>2.826</td>
      <td>2.834</td>
    </tr>
    <tr>
      <td> </td>
      <td>Oil</td>
      <td>tce</td>
      <td>1.574</td>
      <td>1.542</td>
      <td>1.633</td>
      <td>1.671</td>
      <td>1.727</td>
      <td>1.950</td>
      <td>2.189</td>
    </tr>
    <tr>
      <td> </td>
      <td>Nuclear</td>
      <td>tce</td>
      <td>1.101</td>
      <td>0.996</td>
      <td>0.981</td>
      <td>0.983</td>
      <td>0.956</td>
      <td>0.924</td>
      <td>0.943</td>
    </tr>
    <tr>
      <td> </td>
      <td>Hydro</td>
      <td>tce</td>
      <td>0.100</td>
      <td>0.102</td>
      <td>0.108</td>
      <td>0.103</td>
      <td>0.125</td>
      <td>0.108</td>
      <td>0.104</td>
    </tr>
    <tr>
      <td> </td>
      <td>Renewables (Solar Wind)</td>
      <td>tce</td>
      <td>0.014</td>
      <td>0.023</td>
      <td>0.030</td>
      <td>0.038</td>
      <td>0.048</td>
      <td>0.057</td>
      <td>0.069</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Imports</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Coal</td>
      <td>tce</td>
      <td>0.116</td>
      <td>0.112</td>
      <td>0.068</td>
      <td>0.061</td>
      <td>0.042</td>
      <td>0.029</td>
      <td>0.025</td>
    </tr>
    <tr>
      <td> </td>
      <td>Gas</td>
      <td>tce</td>
      <td>0.564</td>
      <td>0.483</td>
      <td>0.450</td>
      <td>0.446</td>
      <td>0.411</td>
      <td>0.370</td>
      <td>0.335</td>
    </tr>
    <tr>
      <td> </td>
      <td>Crude Oil</td>
      <td>tce</td>
      <td>2.619</td>
      <td>2.539</td>
      <td>2.311</td>
      <td>2.344</td>
      <td>2.263</td>
      <td>2.208</td>
      <td>1.939</td>
    </tr>
    <tr>
      <td> </td>
      <td>Oil Products</td>
      <td>tce</td>
      <td>0.820</td>
      <td>0.740</td>
      <td>0.632</td>
      <td>0.608</td>
      <td>0.578</td>
      <td>0.475</td>
      <td>0.462</td>
    </tr>
    <tr>
      <td> </td>
      <td>Electricity</td>
      <td>tce</td>
      <td>0.020</td>
      <td>0.023</td>
      <td>0.020</td>
      <td>0.019</td>
      <td>0.019</td>
      <td>0.022</td>
      <td>0.025</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Exports</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Coal</td>
      <td>tce</td>
      <td>0.186</td>
      <td>0.250</td>
      <td>0.183</td>
      <td>0.249</td>
      <td>0.321</td>
      <td>0.357</td>
      <td>0.332</td>
    </tr>
    <tr>
      <td> </td>
      <td>Gas</td>
      <td>tce</td>
      <td>0.100</td>
      <td>0.115</td>
      <td>0.127</td>
      <td>0.133</td>
      <td>0.177</td>
      <td>0.188</td>
      <td>0.180</td>
    </tr>
    <tr>
      <td> </td>
      <td>Crude Oil</td>
      <td>tce</td>
      <td>0.007</td>
      <td>0.007</td>
      <td>0.010</td>
      <td>0.010</td>
      <td>0.013</td>
      <td>0.016</td>
      <td>0.028</td>
    </tr>
    <tr>
      <td> </td>
      <td>Oil Products</td>
      <td>tce</td>
      <td>0.352</td>
      <td>0.444</td>
      <td>0.486</td>
      <td>0.553</td>
      <td>0.684</td>
      <td>0.730</td>
      <td>0.791</td>
    </tr>
    <tr>
      <td> </td>
      <td>Electricity</td>
      <td>tce</td>
      <td>0.007</td>
      <td>0.010</td>
      <td>0.007</td>
      <td>0.006</td>
      <td>0.006</td>
      <td>0.003</td>
      <td>0.003</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Consumption</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Power Sector</td>
      <td>tce</td>
      <td>4.545</td>
      <td>4.433</td>
      <td>4.146</td>
      <td>4.287</td>
      <td>4.156</td>
      <td>4.014</td>
      <td>3.995</td>
    </tr>
    <tr>
      <td> </td>
      <td>Transport</td>
      <td>tce</td>
      <td>3.472</td>
      <td>3.288</td>
      <td>3.175</td>
      <td>3.201</td>
      <td>3.142</td>
      <td>3.065</td>
      <td>3.072</td>
    </tr>
    <tr>
      <td> </td>
      <td>Industry</td>
      <td>tce</td>
      <td>2.971</td>
      <td>2.835</td>
      <td>2.572</td>
      <td>2.748</td>
      <td>2.750</td>
      <td>2.759</td>
      <td>2.825</td>
    </tr>
    <tr>
      <td> </td>
      <td>Residential</td>
      <td>tce</td>
      <td>1.358</td>
      <td>1.375</td>
      <td>1.330</td>
      <td>1.342</td>
      <td>1.313</td>
      <td>1.201</td>
      <td>1.300</td>
    </tr>
    <tr>
      <td> </td>
      <td>Commercial</td>
      <td>tce</td>
      <td>1.013</td>
      <td>1.026</td>
      <td>0.997</td>
      <td>0.996</td>
      <td>0.992</td>
      <td>0.943</td>
      <td>0.977</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Impact</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>CO2 Emissions</td>
      <td>tons per capita</td>
      <td>19.425</td>
      <td>18.636</td>
      <td>17.261</td>
      <td>17.539</td>
      <td>17.025</td>
      <td>16.483</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Water Use</td>
      <td>gallons per day</td>
      <td>1357.761</td>
      <td>1330.510</td>
      <td>1318.897</td>
      <td>1147.655</td>
      <td>1139.345</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Losses - Power Sector</td>
      <td>tce</td>
      <td>2.915</td>
      <td>2.828</td>
      <td>2.621</td>
      <td>2.712</td>
      <td>2.600</td>
      <td>2.491</td>
      <td>2.480</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td>*Million Metric Ton</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>As you can see, the total and per-capita data are structured in such a way that the values are grouped in sub-categories which are then grouped by category. For example for the category Exports there are sub-cateogries for coal, gas, crude oil, oil products, and electricity. This made it difficult to read the raw data into D3JS directly using the <a href="https://github.com/mbostock/d3/wiki/CSV#csv">d3.csv</a> method. D3 also has a method for <a href="https://github.com/mbostock/d3/wiki/CSV#parse">parsing CSV data</a>, but it didn’t make sense to do a ton of work parsing 8 CSV files in the browser each time the interactive loads or changes due to a button click.</p>

<p>The output JSON data format I decided on would look something like the following schema:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nt">"country-one"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">eg:</span><span class="w"> </span><span class="err">United</span><span class="w"> </span><span class="err">States</span><span class="w">
      </span><span class="nt">"category-one"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">eg:</span><span class="w"> </span><span class="err">production</span><span class="w">
          </span><span class="nt">"sub-category-one"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">eg:</span><span class="w"> </span><span class="err">coal</span><span class="w">
              </span><span class="nt">"total"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">sample</span><span class="w"> </span><span class="err">array</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">total</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">category-one</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="err">sub-category-two</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2007</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">846</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2008</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">859</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2009</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">778</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2010</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">793</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2011</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2012</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">744</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2013</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">720</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">],</span><span class="w"> 
              </span><span class="nt">"per_capita"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">sample</span><span class="w"> </span><span class="err">array</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">per-capita</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">category-one</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="err">sub-category-two</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2007</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">2.800</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2008</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">2.825</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2009</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">2.536</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2010</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">2.564</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2011</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">2.568</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2012</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">2.370</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"year"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2013</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"val"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mf">2.278</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">],</span><span class="w"> 
              </span><span class="nt">"source"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Energy Information Administration"</span><span class="p">]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">data's</span><span class="w"> </span><span class="err">source</span><span class="p">,</span><span class="w"> </span><span class="err">this</span><span class="w"> </span><span class="err">differs</span><span class="w"> </span><span class="err">country</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">country</span><span class="w">
            </span><span class="err">}</span><span class="p">,</span><span class="w">
          </span><span class="nt">"sub-category-two"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">eg:</span><span class="w"> </span><span class="err">gas</span><span class="w">
              </span><span class="nt">"total"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">],</span><span class="w">
              </span><span class="nt">"per_capita"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">],</span><span class="w">
              </span><span class="nt">"source"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">              
          </span><span class="err">//</span><span class="w"> </span><span class="err">additional</span><span class="w"> </span><span class="err">sub-categories</span><span class="w"> </span><span class="err">follow...</span><span class="w">
          </span><span class="err">}</span><span class="p">,</span><span class="w">
        </span><span class="nt">"category-two"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">eg:</span><span class="w"> </span><span class="err">consumption</span><span class="w">
          </span><span class="nt">"sub-category-one"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">eg:</span><span class="w"> </span><span class="err">power-sector</span><span class="w">
              </span><span class="nt">"total"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">],</span><span class="w">
              </span><span class="nt">"per_capita"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">],</span><span class="w">
              </span><span class="nt">"source"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
          </span><span class="err">//</span><span class="w"> </span><span class="err">additional</span><span class="w"> </span><span class="err">sub-categories</span><span class="w"> </span><span class="err">...</span><span class="w">
        </span><span class="err">}</span><span class="w">
        </span><span class="err">//</span><span class="w"> </span><span class="err">additional</span><span class="w"> </span><span class="err">categories</span><span class="w"> </span><span class="err">...</span><span class="w">
      </span><span class="p">},</span><span class="w">          
  </span><span class="nt">"country-two"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">},</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">eg</span><span class="p">:</span><span class="w"> </span><span class="err">Canada</span><span class="w">        
  </span><span class="s2">"country-three"</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">eg:</span><span class="w"> </span><span class="err">China</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>As you can see the raw data will be re-structured into arrays of objects, where each object contains the year and data-value for that year. These arrays are contained in an object representing a sub-category, which is contained in an object representing a category, which are then contained in objects for each country. Having the data structured this way would make the logic for toggling between category and subcategory in the interactive’s user interface fairly straight-forward to code and integrate with D3.</p>

<h2 id="parsing-in-preparation-for-d3js">Parsing in Preparation for D3JS</h2>

<p>To parse the data from it’s original structure to the JSON structure I ended up writing a Node JS script that would take CSV files I downloaded for each worksheet, convert them to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#Creating_a_two-dimensional_array">multi-dimensional arrays</a>, and then output values from those arrays into objects containing the year and data-value. The key parts of the script are the following functions:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">iterateMultiArray</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// iterates over a multi-dimensional array</span>
    <span class="c1">// returns an array of numeric values</span>

    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">arrToReturn</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span><span class="o">===</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">j</span><span class="o">&gt;</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span>
                    <span class="nx">arrToReturn</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">filterFloat</span><span class="p">(</span><span class="nx">tmp</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>               
        <span class="p">}</span>
    <span class="p">}</span>       

    <span class="k">return</span> <span class="nx">mapData2Years</span><span class="p">(</span><span class="nx">arrToReturn</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">mapData2Years</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// maps each value of an array to its corresponding year</span>
    <span class="c1">// preferred data format for d3</span>
    <span class="kd">var</span> <span class="nx">years</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">toReturn</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">obj</span><span class="p">.</span><span class="nx">val</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="nx">obj</span><span class="p">.</span><span class="nx">year</span> <span class="o">=</span> <span class="nx">years</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    
        <span class="c1">// only add the data if it isn't null</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">val</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">toReturn</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
        <span class="p">}</span>       
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="nx">toReturn</span><span class="p">;</span>
<span class="p">}</span> 
 
<span class="c1">// cast data type from string to a number type</span>
<span class="c1">// if no data the value will be NaN and output value in JSON will be null</span>
<span class="kd">function</span> <span class="nx">filterFloat</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/ /g</span><span class="p">,</span><span class="s1">''</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="sr">/^</span><span class="se">(\-</span><span class="sr">|</span><span class="se">\+)?([</span><span class="sr">0-9</span><span class="se">]</span><span class="sr">+</span><span class="se">(\.[</span><span class="sr">0-9</span><span class="se">]</span><span class="sr">+</span><span class="se">)?</span><span class="sr">|Infinity</span><span class="se">)</span><span class="sr">$/</span>
        <span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
  <span class="k">return</span> <span class="kc">NaN</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>The function <code class="highlighter-rouge">iterateMultiArray</code> loops over values in a multi-dimensional array that is a result of using Node’s file system module and a third party fast-csv module to read and parse each CSV file. You can think of mulit-dimensional arrays as lying on an x, y coordinate system that increases from top to bottom and left to right. So the y coordinate will be starting point for the outer array and the x coordinate will be the starting place for the inner array. A nested for-loop then retrieves the value from the inner array. That value is then converted from a string to a number data type and pushed to a temporary array. Finally, when the for-loops finish the temporary array is mapped to an array of years. However, if the data value returned from <code class="highlighter-rouge">filterFloat()</code> is null (<code class="highlighter-rouge">NaN</code>) then no object is created for that particular year. Finally an array of objects is returned.</p>

<p>So for example, if you’d like the value for “coal production” from either the “per-capita” or “total” worksheets you would do <code class="highlighter-rouge">iterateMultiArray(arr,2,2)</code> where <code class="highlighter-rouge">arr</code> is the multi-demnsional array representing the corresponding worksheet. Or if you wanted the value for “residential consumption” you would do <code class="highlighter-rouge">iterateMultiArray(arr,2,27)</code></p>

<p>If you’d like to see the entire script, have a look at <a href="https://gist.github.com/clhenrick/e846432787a6a80065b9">this Gist (code snippet)</a>.</p>

<h2 id="after-thoughts">After Thoughts</h2>
<p>Following the completion of this project I definitely learned a thing or two about improving the workflow for parsing raw data for interactive data visualizations! The main take away I learned is that whatever tool you will be using to visualize your data should determine how the data is structured. Originally I had the data-values in plain old arrays, not objects inside arrays. This proved problematic when there were null values for certain years and we wanted the graph to start drawing at a year later than 2007 or stop drawing at a year earlier than 2013.</p>

<p>The second take away I learned was that there is an API for the Google Sheets App that allows for worksheets to be accessed programatically. I ended up using the <a href="https://github.com/burnash/gspread">GSpread Python module</a> and writing a Python script to automate the process of downloading the worksheets as CSVs each time the client made updates to the data. This was a heck of a lot easier than manually downloading each of 8 sheets and renaming them!</p>

<p>Scripting the data-parsing proved to be a huge time saver, given that the client made frequent changes to the data during our development process. I can’t imagine having had to do all that work on in Excel! If you have any questions or ideas for improvement about this process, feel free to email me at chris [dot] henrick [at] radishlab [dot] com.</p>

<p>cheers,</p>

<p>- Chris</p>

			</span>

			
						<div id="page-meta" class="t30">
				<p>
					<!-- Look the author details up from the site config. -->
					
					<!-- Output author details if some exist. -->
					
					<span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="pr20 icon-edit"><a href="http://clhenrick.io/" target="_blank"> Chris Henrick</a></span>
				</span>
				

				
				<time class="icon-calendar pr20" datetime="2015-08-10" itemprop="datePublished"> 2015-08-10</time>
				

				<span class="icon-archive pr20"> </span>
				<br />
				<span class="pr20"><span class="icon-price-tag pr10"> data</span> <span class="icon-price-tag pr10"> node-js</span> <span class="icon-price-tag pr10"> d3js</span> </span>
			</p>

			<div id="post-nav" class="row">
				
				<div class="small-4 columns text-center"><a class="button small radius prev" href="http://localhost:4000/wrangling-311-data/">&laquo; Wrangling NYC's 311 data</a></div><!-- /.small-4.columns -->
				
				<div class="small-4 columns text-center"><a class="radius button small" href="http://localhost:4000/blog/archive/" title="Blog Archive">Archive</a></div><!-- /.small-4.columns -->
				
				<div class="small-4 columns text-center"><a class="button small radius next" href="http://localhost:4000/using-cartodb-and-datatables/">Using CartoDB for creating data driven web pages &raquo;</a></div><!-- /.small-4.columns -->
				
			</div>
			</div><!--  /.page-meta -->
			

			
						
				<h3 id="comments" class="t60">Dialogue &amp; Discussion</h3>
				<div id="disqus_thread"></div>
				<script>
				    var disqus_config = function () {
				        this.page.url =  'http://localhost:4000'
				        this.page.identifier = '/data-processing-wwc001/';
								this.page.title = 'Data Processing Methodology for "Tracking the Energy Titans"';
				    };
				    (function() {  // DON'T EDIT BELOW THIS LINE
				        var d = document, s = d.createElement('script');

				        s.src = '//clhenrick.disqus.com/embed.js';

				        s.setAttribute('data-timestamp', +new Date());
				        (d.head || d.body).appendChild(s);
				    })();
				</script>
				<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
			

			
		</article>
	</div><!-- /.medium-8.columns -->


	


	
</div><!-- /.row -->


	
	    <div id="up-to-top" class="row">
      <div class="small-12 columns" style="text-align: right;">
        <a class="iconfont" href="#top-of-page">&#xf108;</a>
      </div><!-- /.small-12.columns -->
    </div><!-- /.row -->


    <footer id="footer-content" class="bg-grau">
      <div id="footer">
        <div class="row">
          <div class="medium-6 large-5 columns">
            <h5 class="shadow-black">About This Site</h5>

            <p class="">
              The portfolio and technical blog of Chris Henrick – provider of professional web development, data visualization, GIS, mapping, & cartography services.
              <a href="http://localhost:4000/about/">More ›</a>
            </p>
          </div><!-- /.large-6.columns -->


          <div class="small-6 medium-3 large-3 large-offset-1 columns">
            
              
                <h5 class="shadow-black">Services</h5>
              
            
              
            
              
            
              
            
              
            

              <ul class="no-bullet shadow-black">
              
                
                  <li >
                    <a href=""  title=""></a>
                  </li>
              
                
                  <li >
                    <a href="/contact/"  title="Contact">Contact</a>
                  </li>
              
                
                  <li >
                    <a href="/feed.xml"  title="Subscribe to RSS Feed">RSS</a>
                  </li>
              
                
                  <li >
                    <a href="/atom.xml"  title="Subscribe to Atom Feed">Atom</a>
                  </li>
              
                
                  <li >
                    <a href="/sitemap.xml"  title="Sitemap for Google Webmaster Tools">sitemap.xml</a>
                  </li>
              
              </ul>
          </div><!-- /.large-4.columns -->


          <div class="small-6 medium-3 large-3 columns">
            
              
                <h5 class="shadow-black">Network</h5>
              
            
              
            
              
            

            <ul class="no-bullet shadow-black">
            
              
                <li >
                  <a href=""  title=""></a>
                </li>
            
              
                <li class="services-newsletter" >
                  <a href="http://foundation.zurb.com/" target="_blank"  title="Built on Foundation">Built on Foundation</a>
                </li>
            
              
                <li class="site-code" >
                  <a href="https://github.com/clhenrick/portfolio" target="_blank"  title="Code available on Github">Code on Github</a>
                </li>
            
            </ul>
          </div><!-- /.large-3.columns -->
        </div><!-- /.row -->

      </div><!-- /#footer -->


      <div id="subfooter">
        <nav class="row">
          <section id="subfooter-left" class="small-12 medium-6 columns credits">
            <p>
              Created with &hearts;
              by&nbsp;<a href="http://clhenrick.io/">Chris&nbsp;Henrick</a>
              using&nbsp;<a href="http://jekyllrb.com/" target="_blank">Jekyll</a>
              based&nbsp;on&nbsp;<a href="http://phlow.github.io/feeling-responsive/">Feeling&nbsp;Responsive</a>.
            </p>
          </section>

          <section id="subfooter-right" class="small-12 medium-6 columns">
            <ul class="inline-list social-icons">
            
              <li><a href="https://github.com/clhenrick" target="_blank" class="icon-github" title="Code"></a></li>
            
              <li><a href="https://twitter.com/chrislhenrick" target="_blank" class="icon-twitter" title="Twitter"></a></li>
            
            </ul>
          </section>
        </nav>
      </div><!-- /#subfooter -->
    </footer>

	

	

<!-- jQuery -->
<script src="http://localhost:4000/assets/js/javascript.min.js"></script>
<!-- lazy load -->
<script src="http://localhost:4000/assets/js/jquery.lazyload.min.js"></script>

<script type="text/javascript">
// make all external links open in a new browser tab
// code credit: https://css-tricks.com/snippets/jquery/open-external-links-in-new-window/
$(function(){
  $('a').each(function() {
     var a = new RegExp('/' + window.location.host + '/');
     if(!a.test(this.href)) {
         $(this).click(function(event) {
             event.preventDefault();
             event.stopPropagation();
             window.open(this.href, '_blank');
         });
     }
  });

  // lazy load images with class "lazy"
  $("img.lazy").lazyload({
    threshold: 200,
    effect: "fadeIn"
  });
});

</script>








<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69968207-1', 'auto');
  ga('set', 'anonymizeIp', true);
  ga('send', 'pageview');

</script>







</body>
</html>

